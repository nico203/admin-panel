/*! admin-panel 2017-11-24 */

function navigationController(e,t,n){e.items=n.navigationItems,e.elem=$("navigation"),this.$onInit=function(){t(function(){e.elem=$("navigation"),e.accordion=new Foundation.AccordionMenu(e.elem),e.elem.find("> .menu").addClass("visible")})},this.$onDestroy=function(){e.accordion&&e.accordion.$element.foundation("_destroy")}}function topBarController(e,t,n){e.clickBtn=function(){t.logout(),n.path("/login")},this.$postLink=function(){$("top-bar").foundation()}}angular.module("adminPanel",["ngAnimate","adminPanel.authentication","adminPanel.crud","adminPanel.topBar","adminPanel.navigation"]).directive("adminPanel",[function(){return{restrict:"E",templateUrl:"admin-panel.template.html"}}]),angular.module("adminPanel.crud",["adminPanel","ngResource"]),angular.module("adminPanel.crud").factory("BasicFormController",["CrudConfig",function(e){function t(e,t,n){this.request=null;var a=t.name;e[a]={},this.get=function(n,i){var o=t.property;if(o&&!angular.isUndefined(this[a][o])&&null!==this[a][o])return e[a]=this[a],e[a][o]?e[o]=e[a][o]:e[a][o]=e[o],void(callbackInit&&callbackInit());if(this[a]&&"nuevo"!==this[a]){var r={};r[a]=this[a],form.init(r,function(t){e[a]=t.data,o&&(e[a][o]?e[o]=e[a][o]:e[a][o]=t.data[o]),callbackInit&&callbackInit()})}},this.submit=function(t,n){e.form?e.form.$valid&&form.submit(e[a],function(t){t.data&&(e[a]=t.data),callbackSubmit&&callbackSubmit()}):form.submit(e[a],function(t){t.data&&(e[a]=t.data),callbackSubmit&&callbackSubmit()})},this.destroy=function(){this.request&&this.request.$cancelRequest()}}return t}]),angular.module("adminPanel.crud").factory("BasicListController",["CrudFactory","$timeout",function(e,t){function n(n,a,i){var o=this;n.list=[],o.$$crudFactory=new e(n,a,i),o.init=function(){return o.list(),o},o.list=function(e,a){var i=e?e:{},r=null;return t(function(){var e=a?a:"get";r=o.$$crudFactory.doRequest(e,i).then(function(e){return console.log("list responseSuccess",e),n.list=e.data,n.$broadcast("pagination:paginate",{totalPageCount:e.totalPageCount,currentPageNumber:e.currentPageNumber}),e},function(e){return console.log("list responseError",e),e})}),r},o.destroy=function(){o.request&&o.$$crudFactory.cancelRequest()},n.$on("pagination:changepage",function(e,t){e.stopPropagation(),o.list({page:t})})}return n}]),angular.module("adminPanel.crud").factory("BasicReadController",["CrudService",function(e){function t(t,n,a){this.crudService=e(t,n,a),this.get=function(e,t,n,a){var i=e?e:{};return this.crudService.doRequest("get",i,function(e){},function(e){}),this},this.init=function(){return this.get(),this},this.destroy=function(){this.crudService.cancelRequest()}}return t}]),angular.module("adminPanel.crud").factory("CrudFactory",["CrudConfig",function(e){function t(t,n,a){this.request=null,this.doRequest=function(i,o,r,s){return t.$emit("apLoad:start",a),this.cancelRequest(),this.request=n.$resource[i](o),this.request.$promise.then(function(e){console.log("responseSuccess",e);var n=null;return"string"==typeof r&&(n={message:n,type:"success"}),t.$broadcast("apLoad:finish",a,n),e},function(n){console.log("responseError",n);var i={message:"string"==typeof s?s:e.messages.loadError,type:"success"};return t.$emit("apLoad:finish",a,i),n})},this.cancelRequest=function(){return null===this.request||this.request.$promise.$resolved||this.request.$cancelRequest(),this}}return t}]),angular.module("adminPanel.crud").factory("CrudResource",["CrudConfig","$http","$resource","NormalizeService",function(e,t,n,a){function i(i,o,r,s,l){var u=null,c=null;if("string"==typeof i)u=i;else{if("object"!=typeof i)throw console.error("CrudResourceFactory: el parametro name debe ser string o object"),"CrudResourceFactory: el parametro name debe ser string o object";if(angular.isUndefined(i.name)||angular.isUndefined(i.property))throw console.error("CrudResourceFactory: si el parametro name es un objeto, name y property deben establecerse como propiedades"),"CrudResourceFactory: si el parametro name es un objeto, name y property deben establecerse como propiedades";u=i.name,c=i.property}if("string"!=typeof o)throw console.error("CrudResourceFactory: el parametro url debe ser string"),"CrudResourceFactory: el parametro url debe ser string";if(!angular.isUndefined(r)&&null!==r&&"object"!=typeof r)throw console.error("CrudResourceFactory: el parametro transform debe ser object"),"CrudResourceFactory: el parametro transform debe ser object";var d={};d.query=r&&r.query?function(e){return{data:r.query(e.data)}}:function(e){return e},d.request=r&&r.request?r.request:function(e){return e},d.response=r&&r.response?function(e){return{data:r.response(e.data)}}:function(e){return e};var m={};m[u]="@id";var g={cancellable:!0},p=null;if(!angular.isUndefined(s)&&null!==s&&s!==!1)if(s===!0)p={url:"/files",prop:"file"};else if("string"==typeof s)p={url:"/"+s+"s",prop:s};else if("object"==typeof s){if(angular.isUndefined(s.url)||angular.isUndefined(s.prop))throw console.error("CrudResourceFactory: si el parametro file es un objeto, url y prop deben establecerse como propiedades"),"CrudResourceFactory: si el parametro file es un objeto, url y prop deben establecerse como propiedades";p=s}var f={};for(var h in l){var v=l[h];v.url&&(v.url=e.basePath+v.url),v.cancellable=!0,v.transformResponse&&v.transformResponse.unshift(t.defaults.transformResponse[0]),f[h]=v}return null!==p&&(f[p.prop]={method:"POST",url:e.basePath+o+p.url,transformRequest:[function(e){var t={};return t.id=e.id,console.log("transformRequest, data",e),t[s.prop]=e[s.prop],t},t.defaults.transformRequest[0]],cancellable:!0}),f.query={method:"GET",transformResponse:[t.defaults.transformResponse[0],function(e){for(var t=[],n=0;n<e.length;n++)t.push(d.response(e[n]));return t}],isArray:!1,cancellable:!0},f.get={method:"GET",transformResponse:[t.defaults.transformResponse[0],d.response],cancellable:!0},f.save={method:"POST",transformRequest:[function(e){var t={};return t.id=e.id,c?(t[c]=a.normalize(d.request(e[c])),delete t[c].id):(t[u]=a.normalize(d.request(e)),delete t[u].id),null!==p&&delete t[p.prop],t},t.defaults.transformRequest[0]],cancellable:!0},console.log("actions",f),{name:u,property:c,file:p,$resource:n(e.basePath+o,m,f,g)}}return i}]),angular.module("adminPanel.crud").provider("CrudConfig",function(){var e="",t={saveError:"Hubo un error al guardar los datos en el servidor. Recarga la página e inténtalo de nuevo",saveSusccess:"Datos guardados exitosamente",loadError:"Hubo un error al obtener los datos del servidor. Pruebe con recargar la página"};this.setBasePath=function(t){return e=t,this},this.setMessages=function(e){return t.saveError=e.saveError?e.saveError:t.saveError,t.saveSusccess=e.saveSusccess?e.saveSusccess:t.saveSusccess,t.loadError=e.loadError?e.loadError:t.loadError,this},this.$get=function(){return{basePath:e,messages:t}}}),angular.module("adminPanel.crud").service("CrudService",["$timeout","CrudConfig","$window",function(e,t,n){function a(e,t,n,a,i,r){var s=t.name,l=new o(n,t.$resource,r,t.file);n[s]={},n.submit=function(){n.form?n.form.$valid&&l.submit(n[s],function(e){e.data&&(n[s]=e.data),i&&i()}):l.submit(n[s],function(e){e.data&&(n[s]=e.data),i&&i()})},e.$onInit=function(){var e=t.property;if(e&&!angular.isUndefined(this[s][e])&&null!==this[s][e])return n[s]=this[s],n[s][e]?n[e]=n[s][e]:n[s][e]=n[e],void(a&&a());if(this[s]&&"nuevo"!==this[s]){var i={};i[s]=this[s],l.init(i,function(t){n[s]=t.data,e&&(n[s][e]?n[e]=n[s][e]:n[s][e]=t.data[e]),a&&a()})}},e.$onDestroy=function(){l.destroy()}}function i(e,t,n,a){n.list=[];var i=new r(n,t.$resource,a);e.$onInit=function(){e.list()},e.list=function(e,t,a){var o=e?e:{};i.get(o,function(e){n.list=e.data,n.$broadcast("pagination:paginate",{totalPageCount:e.totalPageCount,currentPageNumber:e.currentPageNumber}),a&&a()},function(){},t)},e.$onDestroy=function(){n.request&&n.request.$cancelRequest()},n.$on("pagination:changepage",function(t,n){t.stopPropagation(),e.list({page:n})})}var o=function(e,a,i,o){var r=this;r.init=function(n,o,s){e.$emit("apLoad:start",i);var l=a.get(n);l.$promise.then(function(t){e.$emit("apLoad:finish",i),o&&o(t)},function(n){console.log("responseError",n),e.$emit("apLoad:finish",i,{message:t.messages.loadError,type:"error"}),s&&s(n)}),r.initRequest=l},r.submit=function(s,l,u){e.$emit("apLoad:start",i),console.log("object",s);var c=a.save(s);c.$promise.then(function(r){if(null===o)n.scrollTo(0,0),e.$emit("apLoad:finish",i,{message:t.messages.saveSusccess,type:"success"}),l&&l(r);else{var s=a[o.prop](r.data);s.$promise.then(function(n){e.$emit("apLoad:finish",i,{message:t.messages.saveSusccess,type:"success"}),l&&l(n)},function(n){throw e.$emit("apLoad:finish",i,{message:t.messages.saveError,type:"error"}),u&&u(n),"Form File Error: "+n})}},function(a){throw n.scrollTo(0,0),e.$emit("apLoad:finish",i,{message:t.messages.saveError,type:"error"}),u&&u(a),"Form Error: "+a}),r.submitRequest=c},r.destroy=function(){r.initRequest&&r.initRequest.$cancelRequest(),r.submitRequest&&r.submitRequest.$cancelRequest()}},r=function(n,a,i){var o=null;this.get=function(r,s,l,u){e(function(){n.$broadcast("apLoad:start",i);var e=u?u:"get";o&&!o.$promise.$resolved&&o.$cancelRequest(),o=a[e](r),o.$promise.then(function(e){n.$broadcast("apLoad:finish",i),s&&s(e)},function(e){-1!==e.status&&(n.$broadcast("apLoad:finish",i,{message:t.messages.loadError,type:"error"}),l&&l(e))}),n.request=o})}};return{form:o,list:r,basicFormController:a,basicListController:i}}]),angular.module("adminPanel.crud").service("NormalizeService",[function(){this.normalize=function(e){var t=angular.copy(e);for(var n in t)if("$"!==n.charAt(0)){var a=n;"object"==typeof t[n]&&null!==t[n]?"undefined"!=typeof t[n].id?t[a]=t[n].id:t[a]=this.normalize(t[n]):t[a]=t[n],n!=a&&delete t[n]}else delete t[n];return t}}]),angular.module("adminPanel.navigation",["adminPanel"]).component("navigation",{templateUrl:"components/navigation/navigation.template.html",controller:["$scope","$timeout","AdminPanelConfig",navigationController]}),angular.module("adminPanel.topBar",["adminPanel.authentication"]).component("topBar",{templateUrl:"components/top-bar/top-bar.template.html",controller:["$scope","AuthenticationService","$location",topBarController]}),angular.module("adminPanel").directive("apAccordion",["$timeout",function(e){return{require:"ngModel",restrict:"AE",transclude:!0,scope:{allowAllClosed:"=",multiExpand:"=",addButtonText:"@?",name:"@?"},link:function(t,n,a,i){n.addClass("ap-accordion"),t.accordion=new Foundation.Accordion(n.find(".accordion"),{"data-multi-expand":t.multiExpand,"data-allow-all-closed":t.allowAllClosed}),t.addElement=function(){var e={},n=t.name?t.name:"default";t.$emit("ap.accordion.add",e,n),angular.isUndefined(i.$modelValue)||i.$modelValue.push(e)},t.removeElement=function(e){t.$emit("ap.accordion.remove",e);var n=i.$modelValue,a=n.indexOf(e);a>-1&&n.splice(a,1)},e(function(){angular.isUndefined(i.$modelValue)&&t.$apply(function(){i.$setViewValue([])})})},controller:["$scope",function(e){this.toggleTab=function(t){e.accordion.$element.foundation("toggle",t)},this.removeElement=function(t){e.removeElement(t)},this.reInitComponent=function(){e.accordion.$element.foundation("up",e.accordion.$tabs.find(".accordion-content")),Foundation.reInit(e.accordion.$element)}}],templateUrl:"directives/accordion/accordion.template.html"}}]),angular.module("adminPanel").directive("apAccordionItem",function(){return{require:["^^apAccordion","ngModel"],restrict:"AE",transclude:!0,scope:{itemDefaultTitle:"@?",deleteButton:"=?"},link:function(e,t,n,a){e.title="",n.$set("dataAccordionItem",""),t.addClass("accordion-item is-active"),a[0].reInitComponent(),e.deleteElement=function(){a[0].removeElement(a[1].$modelValue)},e.toggleTab=function(){a[0].toggleTab(t.find(".accordion-content"))},void 0!==e.itemDefaultTitle&&(e.title=e.itemDefaultTitle)},controller:["$scope",function(e){this.changeTitleName=function(t){e.title=t}}],templateUrl:"directives/accordion/accordionItem.template.html"}}),angular.module("adminPanel").directive("apAccordionItemTitle",["$parse",function(e){return{require:["^^apAccordionItem","ngModel"],restrict:"A",link:function(t,n,a,i){t.objectValues=e(a.apAccordionItemTitle)(t),t.$watch(function(){return i[1].$modelValue},function(e){if(e){var n="";if(e instanceof Date)n=e.toLocaleString();else if(t.objectValues instanceof Array){n="";for(var a=0;a<t.objectValues.length;a++)n+=e[t.objectValues[a]]+", ";n=n.replace(/,\s*$/,"")}else n=e;i[0].changeTitleName(n)}})}}}]),angular.module("adminPanel").directive("apBox",["$rootScope",function(e){return{restrict:"AE",priority:100,transclude:!0,scope:{title:"@",init:"&?"},compile:function(t,n){t.addClass("ap-box");var a="undefined"!=typeof n.paginate;if(a){var i=angular.element("<ap-pagination>");t.find(".pager").append(i)}return function(t,n,a){function i(e,n){t.message=null;var a=n?n:"default";if(!t.loads[a])throw"apLoad: "+a+" not found";t.loads[a].hide()}function o(e,n,a){t.message=a;var i=n?n:"default";if(!t.loads[i])throw"apLoad: "+i+" not found";t.loads[i].show()}function r(){t.elem.removeClass("no-visible"),e.$broadcast("box.directive.mouseenter",t.elem)}function s(e,n){t.elem!==n&&t.elem.addClass("no-visible")}function l(e,n){a.name===n&&(t.isHide=!1)}t.closeButton="undefined"!=typeof a.name,t.message=null,t.loads={},t.elem=n,t.isHide=t.closeButton;for(var u=n.find("[ap-load]"),c=0;c<u.length;c++){var d=angular.element(u[c]).controller("apLoad"),m=d.getName();m&&(t.loads[m]=d)}t.close=function(){t.isHide=!0},t.$watch("isHide",function(e){e?n.hide():n.show()}),n.on("mouseenter",r);var g=t.$on("box.directive.mouseenter",s),p=t.$on("apBox:show",l),f=t.$on("apLoad:start",i),h=t.$on("apLoad:finish",o),v=t.$on("$destroy",function(){n.off("mouseenter",r),g(),p(),f(),h(),v()});t.init&&t.init()}},templateUrl:"directives/box/box.template.html"}}]),angular.module("adminPanel").directive("apDatePicker",["$timeout",function(e){return{restrict:"AE",require:"ngModel",scope:{format:"@?"},link:function(t,n,a,i){function o(n){e(function(){t.$apply(function(){i.$setViewValue(n)})})}n.addClass("row collapse date ap-datepicker"),t.date=null;var r={format:"dd/mm/yyyy"};t.$watch(function(){return i.$modelValue},function(e){if(e){var a=new Date(e);t.date=a,$(n.find(".ap-date")).fdatepicker("update",a)}}),$(n.find(".ap-date")).fdatepicker(r).on("changeDate",function(e){t.date=e.date,t.date.setHours(t.date.getHours()+t.date.getTimezoneOffset()/60),o(t.date)})},templateUrl:"directives/datePicker/datePicker.template.html"}}]),angular.module("adminPanel").directive("apDateTimePicker",["$timeout",function(e){return{restrict:"AE",require:"ngModel",scope:{format:"@?"},link:function(t,n,a,i){function o(n,a,o){var r=angular.isUndefined(a)||null===a?null!==t.hours?t.hours:0:a,s=angular.isUndefined(o)||null===o?null!==t.minutes?t.minutes:0:o;n.setSeconds(0),n.setHours(r),n.setMinutes(s),e(function(){t.$apply(function(){i.$setViewValue(n)})})}n.addClass("row collapse date ap-datetimepicker"),t.hours=null,t.minutes=null,t.date=null;var r={format:"dd/mm/yyyy"};t.$watch(function(){return i.$modelValue},function(e){if(e){var a=new Date(e);t.date=a,$(n.find(".ap-date")).fdatepicker("update",a),t.hours=a.getHours(),t.minutes=a.getMinutes()}}),$(n.find(".ap-date")).fdatepicker(r).on("changeDate",function(e){t.date=e.date,t.date.setHours(t.date.getHours()+t.date.getTimezoneOffset()/60),o(t.date)}),t.changeHour=function(){t.hours<0&&(t.hours=0),t.hours>23&&(t.hours=23),o(t.date,t.hours,t.minutes)},t.changeMinute=function(){t.minutes<0&&(t.minutes=0),t.minutes>59&&(t.minutes=59),o(t.date,t.hours,t.minutes)}},templateUrl:"directives/dateTimePicker/dateTimePicker.template.html"}}]),angular.module("adminPanel").directive("apFilters",["$timeout",function(e){return{restrict:"E",transclude:!0,link:function(t,n,a){var i=null;e(function(){i=n.find(".accordion.filtros"),console.log("elem",i),i.foundation()}),t.$on("$destroy",function(){i.foundation("_destroy")})},templateUrl:"directives/filter/filter.template.html"}}]),angular.module("adminPanel").directive("fieldErrorMessages",[function(){return{restrict:"E",scope:{errors:"="},link:function(e,t){t.addClass("form-error"),console.log("fieldErrorMessages",e)},templateUrl:"directives/form/fieldErrorMessages.template.html"}}]),angular.module("adminPanel").directive("formValidation",["$parse","$compile",function(e,t){return{require:"form",restrict:"A",scope:!0,link:function(n,a,i,o){console.log("formCtrl",o);var r=function(e,t){return angular.isUndefined(t)&&(t=!0),function(n,a){return!t||!e.$isEmpty(a)}},s={required:r},l=e(i.formValidation)(n);n.validations={};for(var u in l){var c=o[u],d=c.$$element;console.log(c);var m={};for(var g in l[u]){var p=l[u][g];c.$validators[g]=s[g](c,p.expression),m[g]=p.message}n.validations[u]={errors:c.$error,messages:m};var f=angular.element('<field-error-messages errors="validations.'+u+'.errors" messages="validations.'+u+'.messages">');t(f)(n),d.after(f)}console.log(n.validations)}}}]),angular.module("adminPanel").directive("formFieldError",["$animate","$compile","AdminPanelConfig",function(e,t,n){return{require:"^form",restrict:"A",scope:{messages:"=?",expr:"="},link:function(a,i,o,r){a.inputElem=i.find("input"),a.inputErrors=r[a.inputElem.attr("name")].$error,a.errors={};for(var s in a.messages)a.errors[s]={expresion:!1,message:a.messages[s]};a.fieldErrorMsgDirective=angular.element("<field-error-messages>"),a.fieldErrorMsgDirective.attr("errors","errors"),i.append(a.fieldErrorMsgDirective),t(a.fieldErrorMsgDirective)(a),a.$watch("inputErrors",function(e){console.log("inputErrors",e);for(var t in e)a.errors[t]||(a.errors[t]={expresion:!1,message:a.messages?a.messages[t]:n.defaultFormMessages[t]}),a.errors[t].expresion=e[t]}),a.$watch("expr",function(t){console.log("val",t),e[t?"addClass":"removeClass"](i,"is-invalid-label"),e[t?"addClass":"removeClass"](a.inputElem,"is-invalid-input"),e[t?"addClass":"removeClass"](a.fieldErrorMsgDirective,"is-visible")})}}}]),angular.module("adminPanel").directive("apImageLoader",[function(){return{require:"ngModel",restrict:"E",scope:!0,link:function(e,t,n,a){function i(t){var n=t.target.files[0];if(n&&o.test(n.type)){var i=new FileReader;i.onload=function(t){e.$apply(function(){var i=t.target.result;e.image.path=i,e.image.name=n.name,a.$setViewValue(n)})},i.readAsDataURL(n)}}t.addClass("ap-image-loader row columns"),e.image={path:null,name:null};var o=/^image\/[a-z]*/g;t.find('input[type="file"]').bind("change",i),e.loadImage=function(){};var r=e.$watch(function(){return a.$modelValue},function(e){console.log("modelValue",e)});e.$on("$destroy",function(){t.find('input[type="file"]').unbind("change",i),r()})},templateUrl:"directives/imageLoader/imageLoader.template.html"}}]),angular.module("adminPanel").directive("apLoad",["$animate","$compile",function(e,t){return{restrict:"A",priority:50,link:function(n,a,i){function o(){var o=i.apLoad;if(0===a.find("[ap-load='"+o+"']").length){n.name=o?o:"default",a.addClass("ap-load");var r=angular.element("<ap-loading-img>");a.append(r),t(r)(n),n.show=function(){e.removeClass(a,"loading")},n.hide=function(){e.addClass(a,"loading")}}}o()},controller:["$scope",function(e){this.getName=function(){return e.name},this.show=function(){e.show()},this.hide=function(){e.hide()}}]}}]),angular.module("adminPanel").directive("apLoadingImg",["AdminPanelConfig",function(e){return{restrict:"AE",priority:60,link:function(t,n){n.addClass("ap-load-image"),t.path=e.imgLoadingRsc},templateUrl:"directives/load/loadingImg.template.html"}}]),angular.module("adminPanel").directive("msfCoordenadas",["$timeout",function(e){return{require:"ngModel",restrict:"E",link:function(t,n,a,i){t.coordenadas="",t.error=!1,e(function(){angular.isUndefined(i.$modelValue)&&(i.$modelValue={latitud:null,longitud:null},console.log("ngModel.$modelValue",i.$modelValue)),t.model={latitud:angular.copy(i.$modelValue.latitud),longitud:angular.copy(i.$modelValue.longitud)}}),t.$watch(function(){return i.$modelValue},function(e){e&&(t.model={latitud:angular.copy(i.$modelValue.latitud),longitud:angular.copy(i.$modelValue.longitud)})}),t.cambioCoordeandas=function(){var e=!1,n=!1;t.error=!1;for(var a=/^(([-])(\d)+((\.)(\d{2})(\d+)))$/,o=/^(([-])(\d)+((\.)(\d{2})(\d+)))$/,r=[",",":"," ","."],s=0;s<r.length;s++){var l=t.coordenadas.replace(/\s+/g,"").split(r[s]);2===l.length?(e=parseFloat(l[0].replace(",",".").match(a)),n=parseFloat(l[1].replace(",",".").match(o))):4===l.length&&(e=parseFloat((l[0]+"."+l[1]).match(a)),n=parseFloat((l[2]+"."+l[3]).match(o)))}return e&&n?(t.model.latitud=e,t.model.longitud=n,i.$setViewValue({latitud:e,longitud:n}),void t.$emit("msfCoordenadas:change",this)):(t.model.latitud="",t.model.longitud="",void(t.error=!0))}},templateUrl:"directives/msfCoordenadas/msfCoordenadas.template.html"}}]),angular.module("adminPanel").directive("apPagination",["AdminPanelConfig",function(e){return{restrict:"AE",priority:50,link:function(t,n,a){var i=function(e){this.currentPage=1,this.pageCount=10,this.pages=[],this.activeLastFirst=!1,this.enableNextPage=!1,this.enablePreviousPage=!1,this.enableFirstPage=!1,this.enableLastPage=!1,this.bottomPage=1,this.topPage=e;var n=function(e,t){for(var n=[],a=e;t>=a;a++)n.push(a);return n};this.rePaginate=function(){var t=Math.floor(e/2),a=!(1===this.bottomPage&&this.currentPage<=t||this.topPage===this.pageCount&&this.currentPage>=this.pageCount-t);a&&(this.currentPage-t<1?(this.bottomPage=1,this.topPage=this.activeLastFirst?e:this.pageCount):this.currentPage+t>this.pageCount?(this.topPage=this.pageCount,this.bottomPage=this.activeLastFirst?this.pageCount-e+1:1):(this.topPage=this.currentPage+t,this.bottomPage=this.currentPage-t),this.pages=n(this.bottomPage,this.topPage))},this.changePage=function(e){this.currentPage!==e&&(t.$emit("pagination:changepage",e),this.currentPage=e,this.enableNextPage=this.currentPage<this.pageCount,this.enablePreviousPage=this.currentPage>1,this.activeLastFirst&&(this.enableFirstPage=this.currentPage>1,this.enableLastPage=this.currentPage<this.pageCount),this.rePaginate())},this.nextPage=function(){if(e!==this.pageCount){var e=this.currentPage+1;this.changePage(e)}},this.previousPage=function(){if(1!==e){var e=this.currentPage-1;this.changePage(e)}},this.init=function(t){this.pageCount=t.totalPageCount,this.currentPage=t.currentPageNumber,this.activeLastFirst=this.pageCount>e,this.enableNextPage=this.currentPage<this.pageCount,this.enableLastPage=this.activeLastFirst&&this.currentPage<this.pageCount,this.bottomPage=1,this.topPage=this.activeLastFirst?e:this.pageCount,this.pages=n(this.bottomPage,this.topPage)},this.reInit=function(e){this.pageCount=e.totalPageCount,this.currentPage=e.currentPageNumber,this.enableNextPage=this.currentPage<this.pageCount,this.enableLastPage=this.activeLastFirst&&this.currentPage<this.pageCount,this.rePaginate()}};t.paginationInit=!1,t.pagination=new i(e.pagination),t.$on("pagination:paginate",function(e,n){t.paginationInit?t.pagination.reInit(n):(t.paginationInit=!0,t.pagination.init(n))})},templateUrl:"directives/pagination/pagination.template.html"}}]),angular.module("adminPanel").directive("apSelect",["$timeout","$rootScope","$q","$injector",function(e,t,n,a){return{restrict:"AE",require:"ngModel",scope:{resource:"@",queryParams:"=?",method:"=?",properties:"="},link:function(i,o,r,s){function l(e){for(var t="",n=0;n<h.length;n++)t+=e[h[n]]+", ";return t=t.replace(/,\s*$/,""),{name:t,$$object:angular.copy(e)}}function u(e){y&&y.$cancelRequest();var t={};if(!e)for(var a=0;a<P.length;a++)t[P[a]]=i.input.model;y=g[$](t),console.log("doRequest"),i.loading=!0;var o=y.$promise.then(function(e){console.log("rSuccess",e);for(var t=e.data&&e.data.length>6?6:e.data.length,n=[],a=0;t>a;a++){var o=e.data[a];n.push(l(o))}return i.lista.items=n,i.lista.desplegado||(i.lista.desplegado=!0),e.data},function(e){n.reject(e)});o["finally"](function(){y.$resolved&&(i.loading=!1)}),i.$emit("ap-select:request",f,o)}function c(){null!==v&&(console.log("cerrar lista"),i.lista.desplegado=!1,y&&y.$cancelRequest(),i.input.model=null===i.itemSelected?"":i.itemSelected.name,i.input.vacio=null===i.itemSelected)}function d(){null===v&&(console.log("abrir lista"),i.lista.desplegado=!0,0===i.lista.items.length&&u(!0))}function m(){null!==v&&(e.cancel(v),v=null,console.log("onListClick timeoutCloseListPromise canceled",v))}console.log(a),o.addClass("select-ap");var g=null;if(a.has(i.resource)){var p=a.get(i.resource,"apSelect");g=p.$resource,console.log("resource",g)}g||console.error("El recurso no esta definido"),i.enableNewButton=!(angular.isUndefined(r["new"])||null===r["new"]);var f=angular.isUndefined(r.name)?"default":r.name,h=angular.isString(i.properies)?i.properties.split(","):i.properties;i.itemSelected=null,i.input={model:null,vacio:!0},i.lista={items:[],desplegado:!1},i.loading=!1;var v=null,b=null,$=angular.isUndefined(i.method)||null===i.method?"get":i.method,P=angular.isString(i.queryParams)?i.queryParams.split(","):i.queryParams||h,y=null,C=!1;i.onChangeInput=function(){i.lista.desplegado||(i.lista.desplegado=!0),i.input.vacio=angular.isUndefined(i.input.model)&&0!==i.input.model.length,u()},i.onFocusInput=function(){console.log("onFocusInput"),i.lista.desplegado||(console.log("onFocusInput timeoutOpenListPromise created"),b=e(d)["finally"](function(){console.log("onFocusInput timeoutOpenListPromise resolved"),b=null}))},i.onBlurInput=function(){console.log("onBlurInput"),null!==b&&(e.cancel(b),b=null,console.log("onBlurInput timeoutOpenListPromise cancelled",b)),v=e(c,100)["finally"](function(){console.log("onBlurInput timeoutCloseListPromise resolved finally"),v=null}),console.log("onBlurInput timeoutCloseListPromise created")},i.onClickButton=function(){console.log("onClickButton"),C||(null!==v&&(e.cancel(v),v=null,console.log("onClickButton timeoutCloseListPromise canceled",v)),console.log("onClickButton give focus input"),o.find("input").focus())},i.onMousedownButton=function(e){console.log("onMousedownButton"),C=i.lista.desplegado,console.log("desplegado",C)},i.onClickItemList=function(e,t){console.log("onClickItemList"),e.stopPropagation(),i.itemSelected=t,s.$setViewValue(t.$$object),i.$emit("ap-select:item-selected",f,t)},i.newObject=function(e){e.stopPropagation(),t.$broadcast("apBox:show",r["new"])},o.on("mousedown",".dropdown-ap",m),i.$watch(function(){return s.$modelValue},function(e){e&&(console.log("val",e),i.itemSelected=l(e),console.log("itemSelected",i.itemSelected),i.input.model=null===i.itemSelected?"":i.itemSelected.name,i.input.vacio=null===i.itemSelected,console.log("scope.input",i.input))});var w=i.$on("$destroy",function(){o.off("mousedown",".dropdown-ap",m),w()})},templateUrl:"directives/select/select.template.html"}}]),angular.module("adminPanel").directive("apTimePicker",["$timeout",function(e){return{restrict:"AE",require:"ngModel",link:function(t,n,a,i){function o(n,a){var o=null===n?null!==t.hours?t.hours:0:n,r=null===a?null!==t.minutes?t.minutes:0:a,s=new Date;s.setSeconds(0),s.setHours(o),s.setMinutes(r),e(function(){t.$apply(function(){i.$setViewValue(s)})})}n.addClass("row collapse date ap-timepicker"),t.hours=null,t.minutes=null,t.$watch(function(){return i.$modelValue},function(e){if(e){var n=new Date(e);t.hours=n.getHours(),t.minutes=n.getMinutes()}}),t.changeHour=function(){t.hours<0&&(t.hours=0),t.hours>23&&(t.hours=23),o(t.hours,t.minutes)},t.changeMinute=function(){t.minutes<0&&(t.minutes=0),t.minutes>59&&(t.minutes=59),o(t.hours,t.minutes)}},templateUrl:"directives/timePicker/timePicker.template.html"}}]),angular.module("adminPanel").filter("highlight",["$sce",function(e){return function(t,n){return n&&(t=t.replace(new RegExp("("+n+")","gi"),'<span class="highlighted">$1</span>')),e.trustAsHtml(t)}}]),angular.module("adminPanel").provider("AdminPanelConfig",function(){var e="",t=11,n={email:"Este campo debe ser un email",max:"Se excedió el numero máximo",maxlength:"El campo tiene demasiados carácteres",min:"No se alcanza el numero minimo de carácteres",minlength:"El texto ingresado es muy corto",number:"Este campo debe ser numérico",pattern:"Este campo no cumple con el patrón especificado",required:"Este campo es requerido",url:"Este campo debe ser una url",date:"Este campo debe ser unna fecha",datetimelocal:"Este campo debe ser una fecha",time:"Ingresa una hora válida",week:"Ingresa una semana válida",month:"El mes no es válido"},a={};this.setImgLoadingIconPath=function(t){return e=t,this},this.setPagesPagination=function(e){return t=e,this},this.setDefaultFormMessenges=function(e){for(var t in e)n[t]=e[t];return this},this.setNavigationItems=function(e){a=angular.copy(e);for(var t in a){a[t].link=a[t].link?"#!"+a[t].link:"#";for(var n in a[t].items)a[t].items[n]="#!"+a[t].items[n]}return this},this.$get=[function(){return{imgLoadingRsc:e,pagination:t,defaultFormMessages:n,navigationItems:a}}]}),angular.module("adminPanel").run(["$templateCache",function(e){e.put("admin-panel.template.html","<div ap-user><div class=wrapper-header><top-bar></top-bar></div><div id=parent><navigation></navigation><div id=content><div class=transition ng-view></div></div></div></div>"),e.put("components/navigation/navigation.template.html",'<ul class="vertical menu"><li ng-repeat="(name, item) in items"><a href={{item.link}} ng-bind=name></a><ul ng-if=item.items class="vertical menu nested"><li ng-repeat="(nestedItemName, nestedItemLink) in item.items"><a href={{nestedItemLink}} ng-bind=nestedItemName></a></li></ul></li></ul>'),e.put("components/top-bar/top-bar.template.html","<div class=top-bar><div class=top-bar-right><ul class=menu><li><button type=button class=button ng-click=clickBtn()>Cerrar Sesión</button></li></ul></div></div>"),e.put("directives/accordion/accordion.template.html",'<div ng-if=addButtonText class="row column"><button type=button class="button secondary" ng-click=addElement() ng-bind=addButtonText></button></div><div class=accordion ng-transclude></div>'),e.put("directives/accordion/accordionItem.template.html",'<div class=accordion-top><button type=button class=accordion-title ng-click=toggleTab() ng-bind=title></button><div class=accordion-button><button type=button ng-if=deleteButton class="button alert" ng-click=deleteElement()><i class="fa fa-remove"></i></button></div></div><div class=accordion-content data-tab-content ng-transclude></div>'),e.put("directives/box/box.template.html","<div class=card><button ng-if=closeButton class=close-button type=button ng-click=close()><span>&times;</span></button><div class=card-divider><h5 ng-bind=title></h5></div><div class=card-section><div ng-if=message class=callout ng-class=\"{'success':message.type === 'success','warning':message.type === 'warning','alert':message.type === 'error'}\" ng-bind=message.message></div><div ng-transclude ap-load></div><div class=pager></div></div></div>"),e.put("directives/datePicker/datePicker.template.html",'<div class=input-group><span class="input-group-label prefix"><i class="fa fa-calendar"></i></span><input class="input-group-field ap-date" type=text readonly></div>'),e.put("directives/dateTimePicker/dateTimePicker.template.html",'<div class=input-group><span class="input-group-label prefix"><i class="fa fa-calendar"></i></span><input class="input-group-field ap-date" type=text readonly><span class=input-group-label>Hs</span><input class=input-group-field type=number style=width:60px ng-model=hours ng-change=changeHour()><span class=input-group-label>Min</span><input class=input-group-field type=number style=width:60px ng-model=minutes ng-change=changeMinute()></div>'),e.put("directives/filter/filter.template.html",'<ul class="accordion filtros" data-accordion data-allow-all-closed=true><li class=accordion-item data-accordion-item><a href=# class=accordion-title>Filtros</a><div class=accordion-content data-tab-content ng-transclude></div></li></ul>'),e.put("directives/form/fieldErrorMessages.template.html",'<div ng-repeat="error in errors" ng-show=error.expresion ng-bind=error.message></div>'),
e.put("directives/imageLoader/imageLoader.template.html",'<div class=image-view><img ng-src={{image.path}} ng-click=loadImage()></div><div class=input-group><div class=input-group-button><label for=exampleFileUpload class="button file"><i class="fa fa-file-image-o"></i></label><input type=file id=exampleFileUpload class=show-for-sr accept=image/*></div><input class=input-group-field type=text readonly ng-value=image.name></div>'),e.put("directives/load/load.template.html","<div ng-show=loading class=ap-load-image><img ng-src={{path}}></div><div ng-hide=loading class=ap-load-content><div ng-if=message class=callout ng-class=\"{'success':message.type === 'success','warning':message.type === 'warning','alert':message.type === 'error'}\" ng-bind=message.message></div><div></div></div>"),e.put("directives/load/loadingImg.template.html","<img ng-src={{path}}>"),e.put("directives/msfCoordenadas/msfCoordenadas.template.html",'<div class="row column"><div class="callout secondary text-center">Podés obtener los datos de<u><a href=https://www.santafe.gov.ar/idesf/servicios/generador-de-coordenadas/tramite.php target=_blank>acá</a></u></div></div><div class="row column"><label ng-class="{\'is-invalid-label\':error}"><input style=margin-bottom:3px type=text ng-class="{\'is-invalid-input\':error}" ng-model=coordenadas ng-change=cambioCoordeandas()><span ng-class="{\'is-visible\':error}" style=margin-top:7px class=form-error>El campo ingresado contiene errores.</span></label></div><div class=row><div class="columns small-12 large-6"><label>Latitud <input type=text ng-value=model.latitud readonly></label></div><div class="columns small-12 large-6"><label>Longitud <input type=text ng-value=model.longitud readonly></label></div></div>'),e.put("directives/pagination/pagination.template.html",'<ul class="pagination text-center" role=navigation><li ng-if=pagination.activeLastFirst class=pagination-previous ng-class="{\'disabled\': !pagination.enablePreviousPage}"><a ng-if=pagination.enablePreviousPage ng-click=pagination.changePage(1)></a></li><li ng-class="{\'disabled\': !pagination.enablePreviousPage}"><a ng-if=pagination.enablePreviousPage ng-click=pagination.previousPage()>&lsaquo;</a><span ng-if=!pagination.enablePreviousPage>&lsaquo;</span></li><li ng-repeat="page in pagination.pages track by $index" ng-class="{\'current\':page === pagination.currentPage}"><a ng-if="page !== pagination.currentPage" ng-bind=page ng-click=pagination.changePage(page)></a><span ng-if="page === pagination.currentPage" ng-bind=page></span></li><li ng-class="{\'disabled\': !pagination.enableNextPage}"><a ng-if=pagination.enableNextPage ng-click=pagination.nextPage()>&rsaquo;</a><span ng-if=!pagination.enableNextPage>&rsaquo;</span></li><li ng-if=pagination.activeLastFirst class=pagination-next ng-class="{\'disabled\': !pagination.enableNextPage}"><a ng-if=pagination.enableNextPage ng-click=pagination.changePage(pagination.pageCount)></a></li></ul>'),e.put("directives/select/select.template.html",'<div class=input-group><input class=input-group-field type=text ng-model=input.model ng-change=onChangeInput() ng-focus=onFocusInput() ng-blur=onBlurInput()><div class=input-group-button><button type=button class="button secondary" ng-click=onClickButton() ng-mousedown=onMousedownButton($event)><span class=caret></span></button></div></div><div class=dropdown-ap ng-class="{\'is-open\':lista.desplegado}"><ul ng-if=loading class=list-group><li style=font-weight:700>Cargando...</li></ul><ul ng-if="!loading && lista.items.length > 0" class=list-group><li ng-repeat="option in lista.items" ng-bind-html="option.name | highlight:input.model" ng-mousedown="onClickItemList($event, option)" ng-class="{\'active\':option.$$object.id === itemSelected.$$object.id}"></li></ul><ul ng-if="!loading && lista.items.length === 0" class=list-group><li style=font-weight:700>No hay resultados</li></ul><ul ng-if=enableNewButton class="list-group new"><li ng-mousedown=newObject($event)><span class="fa fa-plus"></span><span>Nuevo</span></li></ul></div>'),e.put("directives/timePicker/timePicker.template.html","<div class=input-group><span class=input-group-label>Hs</span><input class=input-group-field type=number ng-model=hours ng-change=changeHour()><span class=input-group-label>Min</span><input class=input-group-field type=number ng-model=minutes ng-change=changeMinute()></div>")}]);